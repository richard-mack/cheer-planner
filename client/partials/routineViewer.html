<div ng-controller="routineController" ng-keydown="listenKeys($event)" ng-click="listenClick($event)">
  <div id="Banner">
    <input type="button" value="🏠" ng-click="goHome()">
  </div>
  <button ng-click="newRoutine = 'New Routine'" 
    ng-style="{
      position : 'absolute',
      top:{{topLeft.top - 20}}, 
      left:{{topLeft.left}},
      height : 20
    }">
    Switch Routines
  </button>

  <div id="title" ng-model="routine" style="text-align : center; position: absolute; left : 50%; top : 0%; font-size:24px">
    {{routine.name}}
  </div>

<!-- This is the creation of the floor -->
  <div ng-repeat="n in [0,1,2,3,4,5,6,7,8]"
    id="mat{{n}}"
    style="position: absolute; border: solid 1px; border-collapse: collapse; margin: 0px;"
    ng-style="{ top : {{topLeft.top}}, 
      left : {{n*(matWidth+1)+topLeft.left}},
      height : {{matHeight}},
      width : {{matWidth}}
    }">
  </div>

<!-- Place the athletes on the floor -->
  <div ng-repeat="athleteCountPair in athletePositions" 
    ng-style="{'position': 'absolute', 'left' : athleteCountPair.count.posx, 'top' : athleteCountPair.count.posy, 'z-index' : 0}"
    ng-mouseup="handleCountMouseclick($event)"
    data-drag="true"
    jqyoui-draggable="{onStart : 'startDragging()', onStop : 'stopDragging($event, $ui)', onDrag : 'onDrag($event, $ui)'}"
    id={{athleteCountPair.athlete.id}}
    oncontextmenu="return false" 
    title={{athleteCountPair.count.note}}>
    {{athleteCountPair.athlete.firstName}}
  </div>

<!-- Counts Input -->
  <div ng-style="{
      position : 'absolute',
      left: 1000,
      top : {{matHeight}} + 100
    }">
    Jump to Count: <input id="countInput" ng-keypress="countInputKeypress($event)">
  </div>


<!-- Displays the current counts both in terms of 8 count : count, and the raw count) -->
  <div ng-if="$scope.countsDisplay">
    <div ng-style="{
      'position' : 'absolute',
      left : {{topLeft.left}},
      top : {{topLeft.top}} + {{matHeight}} + 10,
      height : 20,
      'font-size' : 24}">
      Count - 
      <label ng-bind="Math.floor(currentCount / 8) + 1" title="This is the number of the 8 count"></label> : 
      <label ng-bind="currentCount % 8"></label> 
      (<label ng-bind="currentCount" ></label>)
    </div>
    <!-- Arrows for incrementing/decrementing the counts -->
      <div style="position: absolute; top: 717px; left: 129px;">
        <input type="image" src="./up.png" ng-click="jumpToCount(currentCount + 8)" style="height: 10px; width: 10px;">
      </div>
      <div style="position: absolute; top: 747px; left: 129px;">
        <input type="image" src="./down.png" ng-click="jumpToCount(currentCount - 8)" style="height: 10px; width: 10px;">
      </div>
      <div style="position: absolute; top: 717px; left: 160px;">
        <input type="image" src="./up.png" ng-click="jumpToCount(currentCount + 1)" style="height: 10px; width: 10px;">
      </div>
      <div style="position: absolute; top: 747px; left: 160px;">
        <input type="image" src="./down.png" ng-click="jumpToCount(currentCount - 1)" style="height: 10px; width: 10px;">
      </div>
    </div> 


<!-- Displays the note/title for the current count -->
  <div ng-style="{
        'position' : 'absolute',
        left : {{topLeft.left}} + ({{matWidth}}+1)*3,
        top : {{topLeft.top}} + {{matHeight}}+2,}">
    <input id="countNoteInput" ng-style="{
      'text-align' : 'center',
      width: 300,
      'font-size' : 24,
      height: 24,
      'border-style' : 'none',
      padding: 0,
      margin : 0
    }"
    ng-model="currentCountNote"
    ng-keyup="updateCountNote($event)">
  </div>

  <div style="top: 50px"
  ng-style="{
    left : {{9*(matWidth+1)+topLeft.left + 15}},
    'position' : 'absolute'
    }">
    Unused Athletes:
  </div>
  <button ng-click="addingAthlete = {id : createID({prefix : 'A'})}" style="position: absolute; left: 1090px; top:30px;">Add Athlete</button>
  <button id="saveButton" ng-click="save()" ng-disabled="isSaving" style="position: absolute; left: 1280px;">Save</button>
  <!--<div id="delete" ng-style="{
    position : 'absolute',
    top : deleteRegion.top,
    left : deleteRegion.left,
    width : 50,
    height : 50
    }">
    <img src="./trash.png" style="width: 50px; height: 50px;">
  </div>-->
<!-- Begin single athlete display -->
  <div ng-show="viewingCount || addingAthlete || newRoutine" style="height: 100%; width: 100%; background-color: grey; opacity:0.1; z-index:1; position: absolute; top:0px; left: 0px;">
  </div>
  <div ng-show="viewingCount" style="z-index:2; height: 50%; width:50%; left: 25%; top: 25%; position: absolute; background-color: white; border: 1px solid black;">
    <div style="position: relative; height: 10%; background-color: darkgrey; font-size: 36px; border-bottom: 1px solid black; text-align: center;"> Athlete Information </div>
    First name: <input ng-model="viewingCountData.firstName"><br />
    Last Name: <input ng-model="viewingCountData.lastName"><br />
    <label style="font-size: 18px">Count Information</label><br />
    Loaded from: {{viewingCountData.count}} <br />
    Count note: <input ng-model="viewingCountData.note">
    <button style="position: absolute; bottom: 0%; right: 0%; height: 15%; width: 15%" ng-click="viewingCount = false">Cancel</button>
    <button style="position: absolute; bottom: 0%; left: 0%; height: 15%; width: 15%" ng-click="saveViewingCount()">Save</button>
  </div>
<!-- Horizontal and Vertical guide lines -->
  <div id="horizontalDrag" ng-show="isDragging" ng-style="{top : isDragging.top}" style="position: absolute; width : 100%; border-bottom: dotted 1px; height: 1px;"></div>
  <div id="verticalDrag" ng-show="isDragging" ng-style="{left : isDragging.left}" style="position: absolute; height : 100%; border-left: dotted 1px; width: 1px;"></div>

<!-- Add Athlete Prompt -->
  <div ng-show="addingAthlete" style="z-index:2; height: 50%; width: 50%; left: 25%; top: 25%; position: absolute; background-color: white; border: 1px solid black;">
    <div style="position: relative; height: 10%; background-color: darkgrey; font-size: 36px; border-bottom: 1px solid black; text-align: center;">New Athlete</div>
    <label> ID: {{addingAthlete.id}}</label> <br />
    First name: <input ng-model="addingAthlete.firstName"><br />
    Last Name: <input ng-model="addingAthlete.lastName"><br />
    <button style="position: absolute; bottom: 0%; height: 15%; width: 15%" ng-click="addAthlete()"> Save </button>
    <button style="position: absolute; bottom: 0%; height: 15%; width: 15%; right: 0%;" ng-click="addingAthlete = null"> Cancel </button>
  </div>

<!-- New Routine Prompt -->
  <div ng-show="newRoutine" style="z-index:2; height: 50%; width: 50%; left: 25%; top: 25%; position: absolute; background-color: white; border: 1px solid black;">
    <div style="position: relative; height: 10%; background-color: darkgrey; font-size: 36px; border-bottom: 1px solid black; text-align: center;">Switch Routines</div>
    Name of Routine: <input ng-model="newRoutine"><br />
    <button style="position: absolute; bottom: 0%; height: 15%; width: 15%" ng-click="addRoutine()"> Go </button>
    <button style="position: absolute; bottom: 0%; height: 15%; width: 15%; right: 0%;" ng-click="newRoutine = ''"> Cancel </button>
  </div>

<!-- Counts display as a grid -->
  <table style="position: absolute; top: 85%; left: 70%;">
  <tr><th></th><th ng-repeat="n in [1,2,3,4,5,6,7,8]" style="text-align: center;">{{n}}</th></tr>
  <tr ng-repeat="m in [0,1,2]">
  <th>{{getOffsetCount(m,0)/8 + 1}}</th><td ng-repeat="n in [1,2,3,4,5,6,7,8]" ng-bind="routine.notes[getOffsetCount(m,n)]" ng-click="jumpToCount(getOffsetCount(m,n))" style="border: 1px solid black; height: 20px; width: 40px; text-align: center;"
  ng-style="{'background-color' : getOffsetCount(m,n) == currentCount ? 'lightgreen' : 'white'}"></td>
  </tr>
  </table>

<!-- Delete Menu -->
<div>
<input ng-if="deleteContextMenu" ng-style="{
  'position' : 'absolute',
  left : {{deleteContextMenu.left}},
  top : {{deleteContextMenu.top}}
}" type="button" value="Delete" ng-click="deleteAthlete(deleteContextMenu.athleteID)">
</div>
</div>
<div ng-controller="logoutController">
<button ng-click="logout()">Logout</button>
</div>
